# Pending Decisions — Resolved (2026-02-14)

Phase 0 작업 중 자체 판단한 사항들입니다. 검토 후 승인/수정해주세요.

**상태**: 모든 결정 완료 (✅ 5건, ⏸ 보류 1건)

---

## 1. 워크아웃 거리 입력 단위

**결정**: API는 거리를 **meters 단위**로 받는다.

**근거**: 도메인 문서(workout.md)에서 "DB 저장: meters"로 확정.
프론트엔드에서 km로 입력받아 `* 1000`으로 변환하여 API에 전달.

**확인 필요**: 프론트엔드 재설계 시 이 변환 로직을 포함해야 함.
현재 프론트엔드 코드가 어떤 단위로 보내는지 미확인 (Static Export 재설계 시 반영 예정).

**결정**: ✅ 승인 — meters 단위 확정. 인터벌은 m 단위, 나머지 훈련은 km 단위로 UI에서 변환. 수동 입력 비중 낮음 (GPS/파일 업로드 위주).

---

## 2. 페이스 계산 수식 변경

**변경 전**: `pace = duration / 60 / distance` (분/km? — 단위 불명확)
**변경 후**: `pace = duration / (distance / 1000)` (초/km)

**영향**: 기존 DB에 저장된 pace 값과 새 계산 결과가 **호환되지 않음**.
SQLite → PostgreSQL 전환으로 기존 데이터는 사라지므로 영향 없음.

**결정**: ✅ 승인 — 초/km로 DB 저장, UI에서 분'초"/km 형태로 변환 표시 (예: 3'34"/km). 기존 데이터 없으므로 호환성 이슈 없음.

---

## 3. Feed Rate Limiting 방식

**결정**: In-memory Map 기반 (30 req/min per IP)

**한계**:
- 서버 재시작 시 초기화
- 다중 인스턴스 환경에서 공유 안 됨
- `x-forwarded-for` 헤더 조작 가능

**향후**: NestJS 전환 시 Redis 기반 throttling middleware로 교체.
현재는 단일 서버 개발 환경이므로 충분.

**결정**: ⏸ 보류 — NestJS + Redis 기반 throttling으로 대체 예정. 현재 in-memory 구현은 임시.

---

## 4. 기존 SQLite 마이그레이션 삭제

**결정**: `prisma/migrations/` 폴더 전체 삭제 (3개 마이그레이션)

**근거**: SQLite → PostgreSQL 전환으로 마이그레이션 호환 불가.
PostgreSQL 연결 후 `prisma migrate dev`로 새 마이그레이션 생성 필요.
기존 dev.db 데이터(개발 중 테스트 데이터)는 보존 가치 없음.

**결정**: ✅ 승인 — 삭제 완료.

---

## 5. 비밀번호 복잡성 규칙

**현재**: 최소 8자만 검증 (특수문자/대소문자 요구 없음)

**근거**: OAuth 전환 예정이므로 비밀번호 로그인은 임시.
과도한 복잡성 규칙은 UX 저하 우려.

**확인 필요**: OAuth 전환 후 비밀번호 로그인을 완전히 제거할지,
레거시 지원으로 유지할지 결정 필요.

**결정**: ✅ 자체 로그인 완전 제거 확정. OAuth only (카카오/구글/네이버). Admin은 별도 백오피스에서 관리하며 User 테이블과 호환 불필요.

---

## 6. Docker Compose 자격증명

**현재**: `masters` / `masters` (개발용)

**프로덕션**: 반드시 변경 필요. `.env`에서 환경변수로 주입.
docker-compose.yml은 개발 전용으로 간주.

**결정**: ✅ 승인 — 개발용 현재 설정 유지, 프로덕션은 .env에서 환경변수 주입.

---

## 확인 방법

각 항목에 대해:
- ✅ 승인 — 현재 결정 유지
- ❌ 수정 — 변경 방향 알려주세요
- ⏸ 보류 — 나중에 결정
